---
import type { GetStaticPathsOptions, MarkdownInstance, Page } from "astro";
import ProjectCard from "../../components/ProjectCard.astro";
import Section from "../../components/Section.astro";
import Layout from "../../layouts/Layout.astro";
import { ProjectFrontMatter, sortProjectsByDate } from "../../utils/projects";

export async function getStaticPaths({paginate}: GetStaticPathsOptions)  {
	const allProjects = await Astro.glob<ProjectFrontMatter>("./*.md");
	const sortedProjects = sortProjectsByDate(allProjects);

	return paginate(sortedProjects, {pageSize: 3});
}

export interface Props {
	page: Page<MarkdownInstance<ProjectFrontMatter>>;
}

const {page} = Astro.props as Props;

const title = "Projects page " + page.currentPage;
const description = "Here you can read all about the projects I have been working on";
---

<Layout head={{ title, description }}>
  
	<Section>
		<div class="titleContainer">
			<h1 class="title">Marijn Kneppers' projects</h1>
			<div class="description">
				Here you can read all about the projects I have been working on
			</div>
		</div>
	</Section>

	<Section>
		<div class="projectList">
			{page.data.map((project) => (
				<ProjectCard project={project} />
			))}
		</div>
	</Section>
	<Section>
		<div class="projectNavContainer">
			<div class="projectNav olderProjects">
				{page.url.prev &&
					<a href={page.url.prev}>	
						← Older projects
					</a>
				}
			</div>
			<div class="projectNavIndexes">
			{
				[...Array(page.lastPage)].map((_, index) => (
					<a href={`/posts/${(index != 0)? index + 1 : ""}`}>{index + 1}</a>
				))
			}
			</div>
			<div class="projectNav newerProjects">
				{page.url.next &&
					<a href={page.url.next}>	
						Newer projects →
					</a>
				}
			</div>
		</div>
	</Section>

</Layout>

<style>
	.titleContainer {
		text-align: center;
	}
	.title {
		font-weight: 700;
		font-size: 2.25rem;
		line-height: 2.5rem;
	}
	.description {
		margin-top: 0.75rem;
		color: var(--color-gray-200);
	}
	.projectList {
		display: grid;
		border-radius: 0.375rem;
		padding: 0.75rem;
		gap: 1rem;
		background-color: var(--color-slate-800);
	}
	.projectNavContainer {
		display: flex;
		justify-content: space-between;
	}
	.projectNav {
		width: 128px;
	}
	.olderProjects:hover {
		transform: translate(-4px);
	}
	.projectNavIndexes {
		display: flex;
		justify-content: space-around;
		width: 384px;
	}
	.newerProjects:hover {
		transform: translate(-4px);
	}
</style>